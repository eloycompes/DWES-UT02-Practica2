<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:c="jakarta.tags.core">

    <h:head>
        <title>Usuarios y pagos mensuales</title>
        <meta charset="UTF-8"/>
        <style>
            table {
                border-collapse: collapse;
                margin-bottom: 40px;
            }
            th, td {
                border: 1px solid #333;
                padding: 6px 12px;
            }
            th {
                background-color: #007bff;
                color: white;
            }

            .mensaje-rojo {
                color: red;
                font-weight: bold;
            }

            .mensaje-verde {
                color: green;
                font-weight: bold;
            }

        </style>
    </h:head>

    <h:body>
        <h1>Usuarios y Pagos mensuales</h1>
        <hr/>

        <!-- Recorremos la lista de usuarios -->
        <ui:repeat value="#{helloBean.usuarios}" var="usuario">
            <h2>Datos de #{usuario.nombre} #{usuario.apellidos}</h2>
            <ul>
                <li><strong>DNI:</strong> #{usuario.dni}</li>
                <li><strong>Email:</strong> #{usuario.email}</li>
                <li><strong>Edad:</strong> #{usuario.edad}</li>
            </ul>

            <h3>Pagos Mensuales</h3>

            <table>
                <tr>
                    <th>Mes</th>
                    <th>Importe (&#8364;)</th>
                </tr>

                <!-- Bucle listado mes e importe -->

                <ui:repeat value="#{usuario.pagosMensuales}" var="pago">
                    <tr>
                        <td>#{pago.key}</td>
                        <td>                        
                            <!-- <h:outputText value="#{pago.value}">
                                <f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
                            </h:outputText> -->

                            <h:outputText
                                value = "#{pago.value > 0 ? pago.value : 'NO PAGADO'}"
                                styleClass="#{pago.value == 0 ? 'mensaje-rojo' : ''}">
                                <f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
                            </h:outputText>

                        </td>
                    </tr>
                </ui:repeat>


                <!-- Total anual -->

                <tr>
                    <td><strong>Total anual</strong></td>
                    <td>
                        <h:outputText value="#{usuario.totalDeuda}">
                            <f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2" />
                        </h:outputText>
                    </td>
                </tr>
            </table>

            <!-- Mensaje según total anual -->

            <!-- <h:panelGroup rendered="#{usuario.totalDeuda >= 100}">
                <p>El usuario está al corriente de pagos</p>
            </h:panelGroup>

            <h:panelGroup rendered="#{not usuario.estaAlDia}">
                <p>El usuario no está al día con la cuota</p>
            </h:panelGroup> -->

            <h:outputText
                value = "#{usuario.estaAlDia ? 'El usuario está al corriente de pago' : 'El usuario no está al día con la cuota'}"
                styleClass="#{usuario.estaAlDia ? 'mensaje-verde' : 'mensaje-rojo'}"/>

            <hr/>
        </ui:repeat>
    </h:body>
</html>